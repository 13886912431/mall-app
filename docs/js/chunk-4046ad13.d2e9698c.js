(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4046ad13"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},2532:function(e,t,s){"use strict";var n=s("23e7"),i=s("5a34"),r=s("1d80"),o=s("ab13");n({target:"String",proto:!0,forced:!o("includes")},{includes:function(e){return!!~String(r(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},"2d3b":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-wrapper"},[s("div",{staticClass:"search-container flex",class:[e.scrollTop>0?"shadow":""]},[s("van-icon",{staticClass:"arrow-left",attrs:{name:"arrow-left"},on:{click:function(t){return e.$router.transitionBack()}}}),s("van-search",{attrs:{placeholder:e.placeholder,"show-action":"","clear-trigger":"always"},on:{input:e.handleInput,focus:e.handleFocus,blur:e.handleBlur,clear:e.handleClear},scopedSlots:e._u([{key:"action",fn:function(){return[e.showGoodsList?s("van-icon",{attrs:{name:"shopping-cart-o",badge:e.totalCount,id:"shopping"},on:{click:function(t){return e.$router.push("/shopping")}}}):s("div",{on:{click:function(t){return e.onSearch(null)}}},[e._v("搜索")])]},proxy:!0}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e.searchHistory.length>0&&!e.showGoodsList?s("div",{staticClass:"history-wrapper"},[s("div",{staticClass:"top between"},[s("div",{staticClass:"history"},[e._v("历史记录：")]),s("div",{staticClass:"delete",on:{click:e.deleteHistory}},[e._v("删除记录")])]),s("div",{staticClass:"history-list"},e._l(e.searchHistory,(function(t){return s("van-button",{key:t,on:{click:function(s){return e.clickHistory(t)}}},[e._v(" "+e._s(t)+" ")])})),1)]):e._e(),s("van-list",{directives:[{name:"show",rawName:"v-show",value:e.likeSearchList.length>0&&e.showLikeSearch,expression:"likeSearchList.length > 0 && showLikeSearch"}],staticClass:"like-search-list"},e._l(e.likeSearchList,(function(t){return s("van-cell",{key:t,on:{click:function(s){return e.onSearch(t)}},scopedSlots:e._u([{key:"title",fn:function(){return[s("div",{staticClass:"title",domProps:{innerHTML:e._s(t.replace(new RegExp(e.value,"g"),e.value.fontcolor("red")))}})]},proxy:!0}],null,!0)})})),1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showGoodsList&&e.goodsList.length>0,expression:"showGoodsList && goodsList.length > 0"}],staticClass:"goodslist",on:{scroll:function(t){e.scrollTop=t.target.scrollTop}}},[s("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.goodsList,(function(t,n){return s("GoodsCard",e._b({key:n,attrs:{count:e.counterMap[t.id]||0,useFly:!0}},"GoodsCard",t,!1))})),1)],1)],1)},i=[],r=(s("99af"),s("4de4"),s("caad"),s("13d5"),s("fb6a"),s("a434"),s("07ac"),s("ac1f"),s("2532"),s("841c"),s("2909")),o=(s("96cf"),s("1da1")),a=s("5530"),c=s("2f62"),l=s("365c"),u=s("ed08"),h={data:function(){return{value:"",placeholder:"酒",likeSearchList:[],goodsList:[],showLikeSearch:!1,showGoodsList:!1,page:0,loading:!1,finished:!1,changeInput:!1,scrollTop:0,searchHistory:[]}},computed:Object(a["a"])(Object(a["a"])({},Object(c["c"])("goods",{counterMap:"counterMap"})),{},{totalCount:function(){var e=Object.values(this.counterMap).reduce((function(e,t){return e+t}),0);return e>99?"99+":e}}),methods:{onSearch:function(e){this.value=e||(this.value||this.placeholder),this.searchHistory.includes(this.value)&&this.searchHistory.splice(this.searchHistory.indexOf(this.value),1),this.searchHistory.unshift(this.value),localStorage.setItem("searchHistory",JSON.stringify(this.searchHistory.slice(0,10))),this.page=0,this.goodsList=[],this.finished=!1,this.onLoad()},handleInput:function(){this.likeSearchList=[],this.debounceLikeSearch()},handleFocus:function(){this.changeInput&&(this.likeSearchList=[],this.debounceLikeSearch()),this.showGoodsList=!1,this.showLikeSearch=!0},handleBlur:function(){var e=this;setTimeout((function(){e.showLikeSearch=!1,e.goodsList.length>0&&(e.showGoodsList=!0)}),50),this.changeInput=!1},handleClear:function(){this.goodsList=[],this.showHistory=!0,this.showGoodsList=!1},deleteHistory:function(){this.searchHistory=[],localStorage.setItem("searchHistory",JSON.stringify([]))},clickHistory:function(e){this.onSearch(e)},likeSearch:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.value){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,l["a"].likeSearch(e.value);case 4:s=t.sent,e.likeSearchList=s.result.filter((function(t){return t!==e.value})),console.log(e.likeSearchList);case 7:case"end":return t.stop()}}),t)})))()},onLoad:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.page+=1,e.loading=!0,t.next=4,l["a"].search({page:e.page,size:10,type:e.value});case 4:s=t.sent,e.goodsList=[].concat(Object(r["a"])(e.goodsList),Object(r["a"])(s.list)),console.log(s),0===s.total?e.$toast("抱歉！暂时没有该商品"):e.showGoodsList=!0,e.goodsList.length>=s.total?e.finished=!0:e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()}},watch:{value:function(e,t){e!==t&&(this.changeInput=!0)}},created:function(){this.debounceLikeSearch=Object(u["a"])(this.likeSearch,500);var e=localStorage.getItem("searchHistory");e=e?JSON.parse(e):[],this.searchHistory=e}},d=h,f=(s("75b8"),s("2877")),p=Object(f["a"])(d,n,i,!1,null,"7e0e68e7",null);t["default"]=p.exports},"5a34":function(e,t,s){var n=s("44e7");e.exports=function(e){if(n(e))throw TypeError("The method doesn't accept regular expressions");return e}},"75b8":function(e,t,s){"use strict";s("bac1")},"841c":function(e,t,s){"use strict";var n=s("d784"),i=s("825a"),r=s("1d80"),o=s("129f"),a=s("14c3");n("search",1,(function(e,t,s){return[function(t){var s=r(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,s):new RegExp(t)[e](String(s))},function(e){var n=s(t,e,this);if(n.done)return n.value;var r=i(e),c=String(this),l=r.lastIndex;o(l,0)||(r.lastIndex=0);var u=a(r,c);return o(r.lastIndex,l)||(r.lastIndex=l),null===u?-1:u.index}]}))},a434:function(e,t,s){"use strict";var n=s("23e7"),i=s("23cb"),r=s("a691"),o=s("50c4"),a=s("7b0b"),c=s("65f0"),l=s("8418"),u=s("1dde"),h=u("splice"),d=Math.max,f=Math.min,p=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!h},{splice:function(e,t){var s,n,u,h,g,w,k=a(this),y=o(k.length),L=i(e,y),b=arguments.length;if(0===b?s=n=0:1===b?(s=0,n=y-L):(s=b-2,n=f(d(r(t),0),y-L)),y+s-n>p)throw TypeError(v);for(u=c(k,n),h=0;h<n;h++)g=L+h,g in k&&l(u,h,k[g]);if(u.length=n,s<n){for(h=L;h<y-n;h++)g=h+n,w=h+s,g in k?k[w]=k[g]:delete k[w];for(h=y;h>y-n+s;h--)delete k[h-1]}else if(s>n)for(h=y-n;h>L;h--)g=h+n-1,w=h+s-1,g in k?k[w]=k[g]:delete k[w];for(h=0;h<s;h++)k[h+L]=arguments[h+2];return k.length=y-n+s,u}})},ab13:function(e,t,s){var n=s("b622"),i=n("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(s){try{return t[i]=!1,"/./"[e](t)}catch(n){}}return!1}},bac1:function(e,t,s){},caad:function(e,t,s){"use strict";var n=s("23e7"),i=s("4d64").includes,r=s("44d2");n({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("includes")}}]);