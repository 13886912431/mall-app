(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f5a799d6"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},2532:function(t,e,s){"use strict";var n=s("23e7"),i=s("5a34"),r=s("1d80"),o=s("ab13");n({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(r(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"2d3b":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-wrapper"},[s("div",{staticClass:"search-container flex",class:[t.scrollTop>0?"shadow":""]},[s("van-icon",{staticClass:"arrow-left",attrs:{name:"arrow-left"},on:{click:function(e){return t.$router.transitionBack()}}}),s("van-search",{attrs:{placeholder:t.placeholder,"show-action":"","clear-trigger":"always"},on:{input:t.handleInput,focus:t.handleFocus,blur:t.handleBlur,clear:t.handleClear},scopedSlots:t._u([{key:"action",fn:function(){return[t.showGoodsList?s("van-icon",{attrs:{name:"shopping-cart-o",badge:t.totalCount,id:"shopping"},on:{click:function(e){return t.$router.push("/shopping")}}}):s("div",{on:{click:function(e){return t.onSearch(null)}}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t.searchHistory.length>0&&!t.showGoodsList?s("div",{staticClass:"history-wrapper"},[s("div",{staticClass:"top between"},[s("div",{staticClass:"history"},[t._v("历史记录：")]),s("div",{staticClass:"delete",on:{click:t.deleteHistory}},[t._v("删除记录")])]),s("div",{staticClass:"history-list"},t._l(t.searchHistory,(function(e){return s("van-button",{key:e,on:{click:function(s){return t.clickHistory(e)}}},[t._v(" "+t._s(e)+" ")])})),1)]):t._e(),s("van-list",{directives:[{name:"show",rawName:"v-show",value:t.likeSearchList.length>0&&t.showLikeSearch,expression:"likeSearchList.length > 0 && showLikeSearch"}],staticClass:"like-search-list"},t._l(t.likeSearchList,(function(e){return s("van-cell",{key:e,on:{click:function(s){return t.onSearch(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{staticClass:"title",domProps:{innerHTML:t._s(e.replace(new RegExp(t.value,"g"),t.value.fontcolor("red")))}})]},proxy:!0}],null,!0)})})),1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showGoodsList&&t.goodsList.length>0,expression:"showGoodsList && goodsList.length > 0"}],staticClass:"goodslist",on:{scroll:function(e){t.scrollTop=e.target.scrollTop}}},[s("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.goodsList,(function(e,n){return s("GoodsCard",t._b({key:n,attrs:{count:t.counterMap[e.id]||0,useFly:!0}},"GoodsCard",e,!1))})),1)],1)],1)},i=[],r=(s("99af"),s("4de4"),s("caad"),s("13d5"),s("fb6a"),s("a434"),s("07ac"),s("ac1f"),s("2532"),s("841c"),s("2909")),o=(s("96cf"),s("1da1")),a=s("5530"),c=s("2f62"),l=s("365c"),u=s("ed08"),h={data:function(){return{value:"",placeholder:"酒",likeSearchList:[],goodsList:[],showLikeSearch:!1,showGoodsList:!1,page:0,loading:!1,finished:!1,changeInput:!1,scrollTop:0,searchHistory:[]}},computed:Object(a["a"])(Object(a["a"])({},Object(c["c"])("goods",{counterMap:"counterMap"})),{},{totalCount:function(){var t=Object.values(this.counterMap).reduce((function(t,e){return t+e}),0);return t>99?"99+":t}}),methods:{onSearch:function(t){this.value=t||(this.value||this.placeholder),this.searchHistory.includes(this.value)&&this.searchHistory.splice(this.searchHistory.indexOf(this.value),1),this.searchHistory.unshift(this.value),localStorage.setItem("searchHistory",JSON.stringify(this.searchHistory.slice(0,10))),this.page=0,this.goodsList=[],this.finished=!1,this.onLoad()},handleInput:function(){this.likeSearchList=[],this.debounceLikeSearch()},handleFocus:function(){this.changeInput&&(this.likeSearchList=[],this.debounceLikeSearch()),this.showGoodsList=!1,this.showLikeSearch=!0},handleBlur:function(){var t=this;setTimeout((function(){t.showLikeSearch=!1,t.goodsList.length>0&&(t.showGoodsList=!0)}),50),this.changeInput=!1},handleClear:function(){this.goodsList=[],this.showHistory=!0,this.showGoodsList=!1},deleteHistory:function(){this.searchHistory=[],localStorage.setItem("searchHistory",JSON.stringify([]))},clickHistory:function(t){this.onSearch(t)},likeSearch:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.value){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,l["a"].likeSearch(t.value);case 4:s=e.sent,t.likeSearchList=s.result.filter((function(e){return e!==t.value})),console.log(t.likeSearchList);case 7:case"end":return e.stop()}}),e)})))()},onLoad:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.page+=1,t.loading=!0,e.next=4,l["a"].search({page:t.page,size:10,type:t.value});case 4:s=e.sent,t.goodsList=[].concat(Object(r["a"])(t.goodsList),Object(r["a"])(s.list)),console.log(s),0===s.total?t.$toast("抱歉！暂时没有该商品"):t.showGoodsList=!0,t.goodsList.length>=s.total?t.finished=!0:t.loading=!1;case 9:case"end":return e.stop()}}),e)})))()}},watch:{value:function(t,e){t!==e&&(this.changeInput=!0)}},created:function(){this.debounceLikeSearch=Object(u["a"])(this.likeSearch,500);var t=localStorage.getItem("searchHistory");t=t?JSON.parse(t):[],this.searchHistory=t}},d=h,f=(s("8cf8"),s("2877")),p=Object(f["a"])(d,n,i,!1,null,"1a6c493a",null);e["default"]=p.exports},"5a34":function(t,e,s){var n=s("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},"841c":function(t,e,s){"use strict";var n=s("d784"),i=s("825a"),r=s("1d80"),o=s("129f"),a=s("14c3");n("search",1,(function(t,e,s){return[function(e){var s=r(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,s):new RegExp(e)[t](String(s))},function(t){var n=s(e,t,this);if(n.done)return n.value;var r=i(t),c=String(this),l=r.lastIndex;o(l,0)||(r.lastIndex=0);var u=a(r,c);return o(r.lastIndex,l)||(r.lastIndex=l),null===u?-1:u.index}]}))},"8cf8":function(t,e,s){"use strict";s("ad63")},a434:function(t,e,s){"use strict";var n=s("23e7"),i=s("23cb"),r=s("a691"),o=s("50c4"),a=s("7b0b"),c=s("65f0"),l=s("8418"),u=s("1dde"),h=u("splice"),d=Math.max,f=Math.min,p=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!h},{splice:function(t,e){var s,n,u,h,g,w,k=a(this),y=o(k.length),L=i(t,y),S=arguments.length;if(0===S?s=n=0:1===S?(s=0,n=y-L):(s=S-2,n=f(d(r(e),0),y-L)),y+s-n>p)throw TypeError(v);for(u=c(k,n),h=0;h<n;h++)g=L+h,g in k&&l(u,h,k[g]);if(u.length=n,s<n){for(h=L;h<y-n;h++)g=h+n,w=h+s,g in k?k[w]=k[g]:delete k[w];for(h=y;h>y-n+s;h--)delete k[h-1]}else if(s>n)for(h=y-n;h>L;h--)g=h+n-1,w=h+s-1,g in k?k[w]=k[g]:delete k[w];for(h=0;h<s;h++)k[h+L]=arguments[h+2];return k.length=y-n+s,u}})},ab13:function(t,e,s){var n=s("b622"),i=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(s){try{return e[i]=!1,"/./"[t](e)}catch(n){}}return!1}},ad63:function(t,e,s){},caad:function(t,e,s){"use strict";var n=s("23e7"),i=s("4d64").includes,r=s("44d2");n({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")}}]);